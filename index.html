<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>archive beat</title>

<style>
*{box-sizing:border-box}

body{
  margin:0;
  padding:40px 20px;
  background:
    repeating-linear-gradient(
      0deg,
      #f7f6f2,
      #f7f6f2 2px,
      #f5f4f0 3px
    );
  color:#2b2b2b;
  font-family:
    "Hiragino Mincho ProN",
    "Yu Mincho",
    "Times New Roman",
    serif;
  line-height:1.8;
}

.container{
  max-width:900px;
  margin:0 auto;
}

h1{
  font-size:2.4rem;
  font-weight:normal;
  letter-spacing:.14em;
  margin-bottom:6px;
}

.subtitle{
  font-size:.85rem;
  color:#777;
  margin-bottom:30px;
}

.statement{
  font-size:.95rem;
  margin-bottom:40px;
}

.controls{
  margin-bottom:30px;
}

.controls button{
  background:none;
  border:1px solid #aaa;
  padding:6px 14px;
  margin-right:8px;
  font-family:inherit;
  cursor:pointer;
}

.controls button:hover{
  background:#eee;
}

.note{
  font-size:.85rem;
  color:#666;
  margin-bottom:30px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:26px;
}

.beat{
  background:#fff;
  border:1px solid #e2e2e2;
  padding:18px;
  transition:.3s;
}

.beat:hover{
  box-shadow:0 8px 20px rgba(0,0,0,.08);
}

.title{
  font-size:1rem;
  margin-bottom:6px;
}

.meta{
  font-size:.8rem;
  color:#777;
  margin-bottom:10px;
}

.sold{
  display:inline-block;
  font-size:.7rem;
  border:1px solid #999;
  padding:2px 8px;
  margin-bottom:10px;
}

.beat.soldout{
  opacity:.45;
}

audio{
  width:100%;
  margin-top:10px;
}

.footer{
  margin-top:70px;
  font-size:.8rem;
  color:#666;
}

/* 管理者UI */
.admin{
  margin:30px 0;
  display:block;
  border:2px dashed red;
}

.admin-btn{
  position:fixed;
  bottom:14px;
  right:16px;
  font-size:.7rem;
  opacity:.4;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="container">

<h1>archive beat</h1>
<div class="subtitle">sound archive by alouji</div>

<div class="statement"
data-jp="これは公開されなかったビートの保管庫です。いくつかは、見つけられるためにここにあります。"
data-en="This is an archive of unreleased beats. Some are meant to be found.">
これは公開されなかったビートの保管庫です。いくつかは、見つけられるためにここにあります。
</div>

<div class="controls">
  <button onclick="setLang('jp')">JP</button>
  <button onclick="setLang('en')">EN</button>
</div>

<div class="note"
data-jp="非独占 ¥5,000〜 / 独占 ¥30,000〜｜決済：PayPay・銀行振込（DMまで）"
data-en="Non-exclusive ¥5,000+ / Exclusive ¥30,000+ | Payment via PayPay or Bank Transfer (DM)">
非独占 ¥5,000〜 / 独占 ¥30,000〜｜決済：PayPay・銀行振込（DMまで）
</div>

<!-- 管理者だけ見える -->
<div class="admin" id="adminArea">
  <input type="file" accept="audio/*" multiple onchange="addBeats(event)">
</div>

<div id="list" class="grid"></div>

<div class="footer">
© alouji / archive beat
</div>

</div>

<div class="admin-btn" onclick="adminLogin()">admin</div>

<script>
const ADMIN_PASSWORD = "alouji1225"; // ←ここ好きな文字に変えてOK

function setLang(l){
  document.querySelectorAll('[data-jp]').forEach(e=>{
    e.textContent = e.dataset[l]
  })
}

// 管理者ログイン
function adminLogin(){
  const p = prompt("admin password")
  if(p === ADMIN_PASSWORD){
    document.getElementById('adminArea').style.display="block"
    alert("admin mode")
  }
}

function addBeats(e){
  for(const f of e.target.files){

    const beat=document.createElement('div')
    beat.className='beat'

    const title=document.createElement('div')
    title.className='title'
    title.textContent=f.name

    const meta=document.createElement('div')
    meta.className='meta'
    meta.textContent='preview: 30s'

    const sold=document.createElement('div')
    sold.className='sold'
    sold.textContent=''

    const audio=document.createElement('audio')
    audio.controls=true
    audio.src=URL.createObjectURL(f)

    // 30秒で自動停止
    audio.addEventListener('timeupdate',()=>{
      if(audio.currentTime>=30){
        audio.pause()
        audio.currentTime=0
      }
    })

    sold.onclick=()=>{
      beat.classList.add('soldout')
      sold.textContent='SOLD'
      audio.pause()
      audio.disabled=true
    }

    beat.append(title,meta,sold,audio)
    document.getElementById('list').appendChild(beat)
  }
}
</script>

</body>
</html>
